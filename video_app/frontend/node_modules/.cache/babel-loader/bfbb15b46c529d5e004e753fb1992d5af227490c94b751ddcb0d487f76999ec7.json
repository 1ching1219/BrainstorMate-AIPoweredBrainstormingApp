{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\OneDrive\\\\\\u684C\\u9762\\\\HCI+D\\\\video_app\\\\frontend\\\\src\\\\components\\\\VideoRoom.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport axios from 'axios';\nimport Peer from 'simple-peer';\nimport { useNavigate } from 'react-router-dom';\nimport { VideoRoomContainer, Header, RoomTitle, ContentContainer, FeedbackSection, FeedbackHeader, FeedbackItem, Avatar, FeedbackContent, AgentName, FeedbackText, VideoSection, VideoGrid, VideoContainer, ParticipantVideo, ParticipantName, PaginationControls, NavButton } from './StyledComponents'; // 這是假設你有一個樣式文件\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoRoom = ({\n  roomId,\n  userName,\n  aiPartners,\n  participantsPerPage = 4\n}) => {\n  _s();\n  const socketRef = useRef(null);\n  const streamRef = useRef(null);\n  const peersRef = useRef([]);\n  const userVideo = useRef();\n  const [messages, setMessages] = useState([]);\n  const [aiFeedback, setAiFeedback] = useState([]);\n  const [participants, setParticipants] = useState([]);\n  const [peers, setPeers] = useState([]);\n  const [videoEnabled, setVideoEnabled] = useState(true);\n  const [audioEnabled, setAudioEnabled] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n  const navigate = useNavigate();\n  const totalPages = Math.ceil(participants.length / participantsPerPage);\n  const currentParticipants = Array.isArray(participants) ? participants.slice((currentPage - 1) * participantsPerPage, currentPage * participantsPerPage) : [];\n  useEffect(() => {\n    fetchParticipants();\n    fetchMessages();\n    generateAIFeedback();\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      streamRef.current = stream;\n      if (userVideo.current) {\n        userVideo.current.srcObject = stream;\n      }\n    });\n    socketRef.current = new WebSocket(`wss://yourserver.com/ws/rooms/${roomId}/`);\n    socketRef.current.onmessage = event => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'message') {\n        setMessages(prevMessages => [...prevMessages, {\n          sender: data.sender,\n          content: data.message,\n          is_ai: data.is_ai\n        }]);\n        if (data.is_ai && data.message_type === 'feedback') {\n          setAiFeedback(prev => [...prev, {\n            agent: data.sender,\n            content: data.message\n          }]);\n        }\n      } else if (data.type === 'signal') {\n        handleSignal(data);\n      }\n    };\n    socketRef.current.onerror = error => {\n      console.error(\"WebSocket error:\", error);\n    };\n    socketRef.current.onclose = () => {\n      console.log(\"WebSocket connection closed\");\n    };\n    return () => {\n      if (socketRef.current) socketRef.current.close();\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n  const handleSignal = data => {\n    const {\n      signal,\n      caller_id,\n      receiver_id\n    } = data;\n    if (signal.type === 'new-participant' && caller_id !== userName) {\n      const peer = createPeer(caller_id);\n      peersRef.current.push({\n        peerId: caller_id,\n        peer: peer\n      });\n      socketRef.current.send(JSON.stringify({\n        type: 'signal',\n        signal: {\n          type: 'participant-ready'\n        },\n        caller_id: userName,\n        receiver_id: caller_id\n      }));\n    } else if (signal.type === 'participant-ready' && receiver_id === userName) {\n      const peer = addPeer(caller_id, signal);\n      peersRef.current.push({\n        peerId: caller_id,\n        peer: peer\n      });\n    } else if (signal.sdp || signal.candidate) {\n      const item = peersRef.current.find(p => p.peerId === caller_id);\n      if (item) {\n        item.peer.signal(signal);\n      }\n    }\n  };\n  const createPeer = participantId => {\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream: streamRef.current\n    });\n    peer.on('signal', signal => {\n      socketRef.current.send(JSON.stringify({\n        type: 'signal',\n        signal: signal,\n        caller_id: userName,\n        receiver_id: participantId\n      }));\n    });\n    peer.on('stream', stream => {\n      setPeers(users => [...users, {\n        id: participantId,\n        stream: stream\n      }]);\n    });\n    return peer;\n  };\n  const addPeer = (participantId, incomingSignal) => {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream: streamRef.current\n    });\n    peer.on('signal', signal => {\n      socketRef.current.send(JSON.stringify({\n        type: 'signal',\n        signal: signal,\n        caller_id: userName,\n        receiver_id: participantId\n      }));\n    });\n    peer.on('stream', stream => {\n      setPeers(users => [...users, {\n        id: participantId,\n        stream: stream\n      }]);\n    });\n    peer.signal(incomingSignal);\n    return peer;\n  };\n  const fetchParticipants = async () => {\n    try {\n      const response = await axios.get(`/api/rooms/${roomId}/participants/`);\n      setParticipants(response.data);\n    } catch (error) {\n      console.error(\"Error fetching participants:\", error);\n      setParticipants([]); // 預設為空陣列避免錯誤\n    }\n  };\n  const fetchMessages = async () => {\n    try {\n      const response = await axios.get(`/api/rooms/${roomId}/messages/`);\n      setMessages(response.data);\n    } catch (error) {\n      console.error(\"Error fetching messages:\", error);\n    }\n  };\n  const generateAIFeedback = () => {\n    const initialFeedback = aiPartners.map(agent => ({\n      agent: agent.name,\n      content: `Hello, I'm ${agent.name}, your ${agent.role} AI assistant. I'm here to help with the meeting.`\n    }));\n    setAiFeedback(initialFeedback);\n    const feedbackInterval = setInterval(() => {\n      const randomAgent = aiPartners[Math.floor(Math.random() * aiPartners.length)];\n      if (randomAgent) {\n        const feedback = {\n          agent: randomAgent.name,\n          content: generateRandomFeedback(randomAgent.role)\n        };\n        setAiFeedback(prev => [...prev, feedback]);\n        if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\n          socketRef.current.send(JSON.stringify({\n            type: 'message',\n            message: feedback.content,\n            sender: feedback.agent,\n            is_ai: true,\n            message_type: 'feedback'\n          }));\n        }\n      }\n    }, 15000);\n    return () => clearInterval(feedbackInterval);\n  };\n  const generateRandomFeedback = role => {\n    const feedbackOptions = {\n      'Designer': [\"I notice the UI elements could be more consistent. Consider a unified color scheme.\", \"The user flow seems to have some friction points. We should simplify the navigation.\", \"Visual hierarchy could be improved to guide users more effectively.\", \"Have you considered accessibility in this design? Some elements may need better contrast.\"],\n      'Engineer': [\"The current architecture might have scaling issues with high user loads.\", \"We should consider optimizing the database queries for better performance.\", \"This would be a good opportunity to implement caching to reduce server load.\", \"The current solution works, but we might want to refactor for better maintainability.\"],\n      'Finance': [\"Based on our projections, we should allocate more resources to marketing.\", \"The ROI on this feature seems promising based on current metrics.\", \"We need to consider the cost implications of this infrastructure change.\", \"From a financial perspective, we should prioritize features with higher revenue potential.\"],\n      'Professor': [\"This approach aligns with recent research in the field.\", \"Consider the theoretical implications of this decision framework.\", \"We should examine some case studies that have implemented similar solutions.\", \"The methodology needs more rigorous validation before proceeding.\"]\n    };\n    const options = feedbackOptions[role] || [\"I have some insights to share about this discussion.\"];\n    return options[Math.floor(Math.random() * options.length)];\n  };\n  const toggleVideo = () => {\n    if (streamRef.current) {\n      streamRef.current.getVideoTracks().forEach(track => {\n        track.enabled = !videoEnabled;\n      });\n      setVideoEnabled(!videoEnabled);\n    }\n  };\n  const toggleAudio = () => {\n    if (streamRef.current) {\n      streamRef.current.getAudioTracks().forEach(track => {\n        track.enabled = !audioEnabled;\n      });\n      setAudioEnabled(!audioEnabled);\n    }\n  };\n  const leaveRoom = () => {\n    navigate('/');\n  };\n  const sendMessage = message => {\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\n      socketRef.current.send(JSON.stringify({\n        type: 'message',\n        message: message,\n        sender: userName,\n        is_ai: false\n      }));\n    }\n  };\n  const nextPage = () => {\n    if (currentPage < totalPages) {\n      setCurrentPage(currentPage + 1);\n    }\n  };\n  const prevPage = () => {\n    if (currentPage > 1) {\n      setCurrentPage(currentPage - 1);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(VideoRoomContainer, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      children: /*#__PURE__*/_jsxDEV(RoomTitle, {\n        children: [\"Room \", roomId]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ContentContainer, {\n      children: [/*#__PURE__*/_jsxDEV(FeedbackSection, {\n        children: [/*#__PURE__*/_jsxDEV(FeedbackHeader, {\n          children: \"AI Partner Feedback\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this), aiFeedback.map((feedback, index) => /*#__PURE__*/_jsxDEV(FeedbackItem, {\n          children: [/*#__PURE__*/_jsxDEV(Avatar, {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: `/img/${feedback.agent.toLowerCase()}.png`,\n              alt: feedback.agent,\n              style: {\n                width: '100%',\n                height: '100%',\n                objectFit: 'cover',\n                borderRadius: '50%'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(FeedbackContent, {\n            children: [/*#__PURE__*/_jsxDEV(AgentName, {\n              children: feedback.agent\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(FeedbackText, {\n              children: feedback.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 15\n          }, this)]\n        }, `feedback-${index}`, true, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(VideoSection, {\n        children: [/*#__PURE__*/_jsxDEV(VideoGrid, {\n          children: [currentParticipants.map((participant, index) => participant.isCurrentUser ? /*#__PURE__*/_jsxDEV(VideoContainer, {\n            children: [videoEnabled ? /*#__PURE__*/_jsxDEV(ParticipantVideo, {\n              ref: userVideo,\n              autoPlay: true,\n              playsInline: true,\n              muted: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 21\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: '100%',\n                height: '100%',\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                backgroundColor: '#333',\n                color: 'white',\n                fontSize: '24px',\n                fontWeight: 'bold'\n              },\n              children: participant.id.charAt(0).toUpperCase()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(ParticipantName, {\n              children: [participant.id, \" (You)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 19\n            }, this)]\n          }, `user-${participant.id}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 333,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(VideoContainer, {\n            children: [/*#__PURE__*/_jsxDEV(ParticipantVideo, {\n              autoPlay: true,\n              playsInline: true,\n              ref: element => {\n                if (element && participant.stream) {\n                  element.srcObject = participant.stream;\n                }\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(ParticipantName, {\n              children: participant.id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 19\n            }, this)]\n          }, `peer-${participant.id}`, true, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 17\n          }, this)), Array.from({\n            length: Math.max(0, participantsPerPage - currentParticipants.length)\n          }).map((_, index) => /*#__PURE__*/_jsxDEV(VideoContainer, {\n            style: {\n              backgroundColor: '#f0f0f0'\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'center',\n                alignItems: 'center',\n                height: '100%',\n                color: '#999'\n              },\n              children: \"Empty Slot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 17\n            }, this)\n          }, `empty-${index}`, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }, this), totalPages > 1 && /*#__PURE__*/_jsxDEV(PaginationControls, {\n          children: [/*#__PURE__*/_jsxDEV(NavButton, {\n            onClick: prevPage,\n            disabled: currentPage === 1,\n            children: \"<\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [currentPage, \" / \", totalPages]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(NavButton, {\n            onClick: nextPage,\n            disabled: currentPage === totalPages,\n            children: \">\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 302,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoRoom, \"7yDjfbRlSq0lqYeyAqnupZylioo=\", false, function () {\n  return [useNavigate];\n});\n_c = VideoRoom;\nexport default VideoRoom;\nvar _c;\n$RefreshReg$(_c, \"VideoRoom\");","map":{"version":3,"names":["React","useEffect","useRef","useState","axios","Peer","useNavigate","VideoRoomContainer","Header","RoomTitle","ContentContainer","FeedbackSection","FeedbackHeader","FeedbackItem","Avatar","FeedbackContent","AgentName","FeedbackText","VideoSection","VideoGrid","VideoContainer","ParticipantVideo","ParticipantName","PaginationControls","NavButton","jsxDEV","_jsxDEV","VideoRoom","roomId","userName","aiPartners","participantsPerPage","_s","socketRef","streamRef","peersRef","userVideo","messages","setMessages","aiFeedback","setAiFeedback","participants","setParticipants","peers","setPeers","videoEnabled","setVideoEnabled","audioEnabled","setAudioEnabled","currentPage","setCurrentPage","navigate","totalPages","Math","ceil","length","currentParticipants","Array","isArray","slice","fetchParticipants","fetchMessages","generateAIFeedback","navigator","mediaDevices","getUserMedia","video","audio","then","stream","current","srcObject","WebSocket","onmessage","event","data","JSON","parse","type","prevMessages","sender","content","message","is_ai","message_type","prev","agent","handleSignal","onerror","error","console","onclose","log","close","getTracks","forEach","track","stop","signal","caller_id","receiver_id","peer","createPeer","push","peerId","send","stringify","addPeer","sdp","candidate","item","find","p","participantId","initiator","trickle","on","users","id","incomingSignal","response","get","initialFeedback","map","name","role","feedbackInterval","setInterval","randomAgent","floor","random","feedback","generateRandomFeedback","readyState","OPEN","clearInterval","feedbackOptions","options","toggleVideo","getVideoTracks","enabled","toggleAudio","getAudioTracks","leaveRoom","sendMessage","nextPage","prevPage","children","fileName","_jsxFileName","lineNumber","columnNumber","index","src","toLowerCase","alt","style","width","height","objectFit","borderRadius","participant","isCurrentUser","ref","autoPlay","playsInline","muted","display","justifyContent","alignItems","backgroundColor","color","fontSize","fontWeight","charAt","toUpperCase","element","from","max","_","onClick","disabled","_c","$RefreshReg$"],"sources":["C:/Users/user/OneDrive/桌面/HCI+D/video_app/frontend/src/components/VideoRoom.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport axios from 'axios';\r\nimport Peer from 'simple-peer';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  VideoRoomContainer, Header, RoomTitle, ContentContainer,\r\n  FeedbackSection, FeedbackHeader, FeedbackItem, Avatar,\r\n  FeedbackContent, AgentName, FeedbackText, VideoSection,\r\n  VideoGrid, VideoContainer, ParticipantVideo, ParticipantName,\r\n  PaginationControls, NavButton\r\n} from './StyledComponents'; // 這是假設你有一個樣式文件\r\n\r\nconst VideoRoom = ({ roomId, userName, aiPartners, participantsPerPage = 4 }) => {\r\n  const socketRef = useRef(null);\r\n  const streamRef = useRef(null);\r\n  const peersRef = useRef([]);\r\n  const userVideo = useRef();\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  const [aiFeedback, setAiFeedback] = useState([]);\r\n  const [participants, setParticipants] = useState([]);\r\n  const [peers, setPeers] = useState([]);\r\n  const [videoEnabled, setVideoEnabled] = useState(true);\r\n  const [audioEnabled, setAudioEnabled] = useState(true);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const totalPages = Math.ceil(participants.length / participantsPerPage);\r\n  const currentParticipants = Array.isArray(participants)\r\n    ? participants.slice((currentPage - 1) * participantsPerPage, currentPage * participantsPerPage)\r\n    : [];\r\n\r\n  useEffect(() => {\r\n    fetchParticipants();\r\n    fetchMessages();\r\n    generateAIFeedback();\r\n\r\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\r\n      .then(stream => {\r\n        streamRef.current = stream;\r\n        if (userVideo.current) {\r\n          userVideo.current.srcObject = stream;\r\n        }\r\n      });\r\n\r\n    socketRef.current = new WebSocket(`wss://yourserver.com/ws/rooms/${roomId}/`);\r\n\r\n    socketRef.current.onmessage = (event) => {\r\n      const data = JSON.parse(event.data);\r\n\r\n      if (data.type === 'message') {\r\n        setMessages(prevMessages => [...prevMessages, {\r\n          sender: data.sender,\r\n          content: data.message,\r\n          is_ai: data.is_ai\r\n        }]);\r\n\r\n        if (data.is_ai && data.message_type === 'feedback') {\r\n          setAiFeedback(prev => [...prev, {\r\n            agent: data.sender,\r\n            content: data.message\r\n          }]);\r\n        }\r\n      } else if (data.type === 'signal') {\r\n        handleSignal(data);\r\n      }\r\n    };\r\n\r\n    socketRef.current.onerror = (error) => {\r\n      console.error(\"WebSocket error:\", error);\r\n    };\r\n\r\n    socketRef.current.onclose = () => {\r\n      console.log(\"WebSocket connection closed\");\r\n    };\r\n\r\n    return () => {\r\n      if (socketRef.current) socketRef.current.close();\r\n      if (streamRef.current) {\r\n        streamRef.current.getTracks().forEach(track => track.stop());\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const handleSignal = (data) => {\r\n    const { signal, caller_id, receiver_id } = data;\r\n\r\n    if (signal.type === 'new-participant' && caller_id !== userName) {\r\n      const peer = createPeer(caller_id);\r\n\r\n      peersRef.current.push({\r\n        peerId: caller_id,\r\n        peer: peer\r\n      });\r\n\r\n      socketRef.current.send(JSON.stringify({\r\n        type: 'signal',\r\n        signal: { type: 'participant-ready' },\r\n        caller_id: userName,\r\n        receiver_id: caller_id\r\n      }));\r\n    } else if (signal.type === 'participant-ready' && receiver_id === userName) {\r\n      const peer = addPeer(caller_id, signal);\r\n\r\n      peersRef.current.push({\r\n        peerId: caller_id,\r\n        peer: peer\r\n      });\r\n    } else if (signal.sdp || signal.candidate) {\r\n      const item = peersRef.current.find(p => p.peerId === caller_id);\r\n      if (item) {\r\n        item.peer.signal(signal);\r\n      }\r\n    }\r\n  };\r\n\r\n  const createPeer = (participantId) => {\r\n    const peer = new Peer({\r\n      initiator: true,\r\n      trickle: false,\r\n      stream: streamRef.current\r\n    });\r\n\r\n    peer.on('signal', signal => {\r\n      socketRef.current.send(JSON.stringify({\r\n        type: 'signal',\r\n        signal: signal,\r\n        caller_id: userName,\r\n        receiver_id: participantId\r\n      }));\r\n    });\r\n\r\n    peer.on('stream', stream => {\r\n      setPeers(users => [...users, {\r\n        id: participantId,\r\n        stream: stream\r\n      }]);\r\n    });\r\n\r\n    return peer;\r\n  };\r\n\r\n  const addPeer = (participantId, incomingSignal) => {\r\n    const peer = new Peer({\r\n      initiator: false,\r\n      trickle: false,\r\n      stream: streamRef.current\r\n    });\r\n\r\n    peer.on('signal', signal => {\r\n      socketRef.current.send(JSON.stringify({\r\n        type: 'signal',\r\n        signal: signal,\r\n        caller_id: userName,\r\n        receiver_id: participantId\r\n      }));\r\n    });\r\n\r\n    peer.on('stream', stream => {\r\n      setPeers(users => [...users, {\r\n        id: participantId,\r\n        stream: stream\r\n      }]);\r\n    });\r\n\r\n    peer.signal(incomingSignal);\r\n\r\n    return peer;\r\n  };\r\n\r\n  const fetchParticipants = async () => {\r\n    try {\r\n      const response = await axios.get(`/api/rooms/${roomId}/participants/`);\r\n      setParticipants(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching participants:\", error);\r\n      setParticipants([]); // 預設為空陣列避免錯誤\r\n    }\r\n  };\r\n\r\n  const fetchMessages = async () => {\r\n    try {\r\n      const response = await axios.get(`/api/rooms/${roomId}/messages/`);\r\n      setMessages(response.data);\r\n    } catch (error) {\r\n      console.error(\"Error fetching messages:\", error);\r\n    }\r\n  };\r\n\r\n  const generateAIFeedback = () => {\r\n    const initialFeedback = aiPartners.map(agent => ({\r\n      agent: agent.name,\r\n      content: `Hello, I'm ${agent.name}, your ${agent.role} AI assistant. I'm here to help with the meeting.`\r\n    }));\r\n\r\n    setAiFeedback(initialFeedback);\r\n\r\n    const feedbackInterval = setInterval(() => {\r\n      const randomAgent = aiPartners[Math.floor(Math.random() * aiPartners.length)];\r\n      if (randomAgent) {\r\n        const feedback = {\r\n          agent: randomAgent.name,\r\n          content: generateRandomFeedback(randomAgent.role)\r\n        };\r\n\r\n        setAiFeedback(prev => [...prev, feedback]);\r\n\r\n        if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n          socketRef.current.send(JSON.stringify({\r\n            type: 'message',\r\n            message: feedback.content,\r\n            sender: feedback.agent,\r\n            is_ai: true,\r\n            message_type: 'feedback'\r\n          }));\r\n        }\r\n      }\r\n    }, 15000);\r\n\r\n    return () => clearInterval(feedbackInterval);\r\n  };\r\n\r\n  const generateRandomFeedback = (role) => {\r\n    const feedbackOptions = {\r\n      'Designer': [\r\n        \"I notice the UI elements could be more consistent. Consider a unified color scheme.\",\r\n        \"The user flow seems to have some friction points. We should simplify the navigation.\",\r\n        \"Visual hierarchy could be improved to guide users more effectively.\",\r\n        \"Have you considered accessibility in this design? Some elements may need better contrast.\"\r\n      ],\r\n      'Engineer': [\r\n        \"The current architecture might have scaling issues with high user loads.\",\r\n        \"We should consider optimizing the database queries for better performance.\",\r\n        \"This would be a good opportunity to implement caching to reduce server load.\",\r\n        \"The current solution works, but we might want to refactor for better maintainability.\"\r\n      ],\r\n      'Finance': [\r\n        \"Based on our projections, we should allocate more resources to marketing.\",\r\n        \"The ROI on this feature seems promising based on current metrics.\",\r\n        \"We need to consider the cost implications of this infrastructure change.\",\r\n        \"From a financial perspective, we should prioritize features with higher revenue potential.\"\r\n      ],\r\n      'Professor': [\r\n        \"This approach aligns with recent research in the field.\",\r\n        \"Consider the theoretical implications of this decision framework.\",\r\n        \"We should examine some case studies that have implemented similar solutions.\",\r\n        \"The methodology needs more rigorous validation before proceeding.\"\r\n      ]\r\n    };\r\n\r\n    const options = feedbackOptions[role] || [\"I have some insights to share about this discussion.\"];\r\n    return options[Math.floor(Math.random() * options.length)];\r\n  };\r\n\r\n  const toggleVideo = () => {\r\n    if (streamRef.current) {\r\n      streamRef.current.getVideoTracks().forEach(track => {\r\n        track.enabled = !videoEnabled;\r\n      });\r\n      setVideoEnabled(!videoEnabled);\r\n    }\r\n  };\r\n\r\n  const toggleAudio = () => {\r\n    if (streamRef.current) {\r\n      streamRef.current.getAudioTracks().forEach(track => {\r\n        track.enabled = !audioEnabled;\r\n      });\r\n      setAudioEnabled(!audioEnabled);\r\n    }\r\n  };\r\n\r\n  const leaveRoom = () => {\r\n    navigate('/');\r\n  };\r\n\r\n  const sendMessage = (message) => {\r\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n      socketRef.current.send(JSON.stringify({\r\n        type: 'message',\r\n        message: message,\r\n        sender: userName,\r\n        is_ai: false\r\n      }));\r\n    }\r\n  };\r\n\r\n  const nextPage = () => {\r\n    if (currentPage < totalPages) {\r\n      setCurrentPage(currentPage + 1);\r\n    }\r\n  };\r\n\r\n  const prevPage = () => {\r\n    if (currentPage > 1) {\r\n      setCurrentPage(currentPage - 1);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <VideoRoomContainer>\r\n      <Header>\r\n        <RoomTitle>Room {roomId}</RoomTitle>\r\n      </Header>\r\n\r\n      <ContentContainer>\r\n        {/* AI Feedback Section */}\r\n        <FeedbackSection>\r\n          <FeedbackHeader>AI Partner Feedback</FeedbackHeader>\r\n          {aiFeedback.map((feedback, index) => (\r\n            <FeedbackItem key={`feedback-${index}`}>\r\n              <Avatar>\r\n                <img\r\n                  src={`/img/${feedback.agent.toLowerCase()}.png`}\r\n                  alt={feedback.agent}\r\n                  style={{ width: '100%', height: '100%', objectFit: 'cover', borderRadius: '50%' }}\r\n                />\r\n              </Avatar>\r\n              <FeedbackContent>\r\n                <AgentName>{feedback.agent}</AgentName>\r\n                <FeedbackText>{feedback.content}</FeedbackText>\r\n              </FeedbackContent>\r\n            </FeedbackItem>\r\n          ))}\r\n        </FeedbackSection>\r\n\r\n        {/* Human Video Section */}\r\n        <VideoSection>\r\n          <VideoGrid>\r\n            {currentParticipants.map((participant, index) => (\r\n              participant.isCurrentUser ? (\r\n                <VideoContainer key={`user-${participant.id}`}>\r\n                  {videoEnabled ? (\r\n                    <ParticipantVideo\r\n                      ref={userVideo}\r\n                      autoPlay\r\n                      playsInline\r\n                      muted\r\n                    />\r\n                  ) : (\r\n                    <div style={{\r\n                      width: '100%',\r\n                      height: '100%',\r\n                      display: 'flex',\r\n                      justifyContent: 'center',\r\n                      alignItems: 'center',\r\n                      backgroundColor: '#333',\r\n                      color: 'white',\r\n                      fontSize: '24px',\r\n                      fontWeight: 'bold'\r\n                    }}>\r\n                      {participant.id.charAt(0).toUpperCase()}\r\n                    </div>\r\n                  )}\r\n                  <ParticipantName>{participant.id} (You)</ParticipantName>\r\n                </VideoContainer>\r\n              ) : (\r\n                <VideoContainer key={`peer-${participant.id}`}>\r\n                  <ParticipantVideo\r\n                    autoPlay\r\n                    playsInline\r\n                    ref={(element) => {\r\n                      if (element && participant.stream) {\r\n                        element.srcObject = participant.stream;\r\n                      }\r\n                    }}\r\n                  />\r\n                  <ParticipantName>{participant.id}</ParticipantName>\r\n                </VideoContainer>\r\n              )\r\n            ))}\r\n\r\n            {/* Empty slots */}\r\n            {Array.from({ length: Math.max(0, participantsPerPage - currentParticipants.length) }).map((_, index) => (\r\n              <VideoContainer key={`empty-${index}`} style={{ backgroundColor: '#f0f0f0' }}>\r\n                <div style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'center',\r\n                  alignItems: 'center',\r\n                  height: '100%',\r\n                  color: '#999'\r\n                }}>\r\n                  Empty Slot\r\n                </div>\r\n              </VideoContainer>\r\n            ))}\r\n          </VideoGrid>\r\n\r\n          {/* Pagination */}\r\n          {totalPages > 1 && (\r\n            <PaginationControls>\r\n              <NavButton onClick={prevPage} disabled={currentPage === 1}>\r\n                &lt;\r\n              </NavButton>\r\n              <span>{currentPage} / {totalPages}</span>\r\n              <NavButton onClick={nextPage} disabled={currentPage === totalPages}>\r\n                &gt;\r\n              </NavButton>\r\n            </PaginationControls>\r\n          )}\r\n        </VideoSection>\r\n      </ContentContainer>\r\n    </VideoRoomContainer>\r\n  );\r\n};\r\n\r\nexport default VideoRoom;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}